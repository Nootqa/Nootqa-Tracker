<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>NOOTQA – Tracker Qur'an Hifdh & Mourāja'a (Interactif)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
    }

    :root {
      --bg: #f4f2f8;
      --card: #ffffff;
      --primary: #6b4a7a;
      --primary-soft: #f4edf9;
      --border-soft: #e1d6ec;
      --text-main: #222222;
      --text-soft: #666666;
      --text-muted: #999999;
      --mem-color: #6b4a7a;
      --rev-color: #89978a;
    }

    body {
      margin: 0;
      padding: 16px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #f9f6ff, #f4f2f8);
      color: var(--text-main);
    }

    .app {
      max-width: 900px;
      margin: 0 auto 32px auto;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }

    .brand {
      font-size: 0.8rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: var(--text-muted);
      white-space: nowrap;
    }

    .lang-switch {
      display: flex;
      gap: 6px;
      align-items: center;
      font-size: 0.8rem;
    }

    .lang-label {
      color: var(--text-muted);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }

    .lang-btn {
      border: 1px solid var(--border-soft);
      border-radius: 999px;
      padding: 4px 9px;
      background: #ffffff;
      font-size: 0.78rem;
      cursor: pointer;
      color: var(--text-soft);
    }

    .lang-btn.active {
      background: var(--primary);
      color: #fff;
      border-color: var(--primary);
    }

    .bismillah {
      text-align: center;
      font-size: 1.45rem;
      margin: 10px 0 4px 0;
      color: var(--primary);
      font-weight: 600;
      direction: rtl;
    }

    h1 {
      text-align: center;
      margin: 4px 0 6px 0;
      font-size: 1.1rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--text-soft);
    }

    .subtitle {
      text-align: center;
      font-size: 0.88rem;
      color: var(--text-soft);
      margin-bottom: 16px;
    }

    .card {
      background: var(--card);
      border-radius: 18px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.06);
      overflow: hidden;
      border: 1px solid var(--border-soft);
    }

    .header-ribbon {
      background: var(--primary);
      padding: 14px 16px;
      color: #fff;
    }

    .header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .header-text {
      flex: 1;
      min-width: 180px;
    }

    .surah-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      opacity: 0.8;
      margin-bottom: 4px;
    }

    .surah-name {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 3px;
    }

    .surah-meta {
      font-size: 0.75rem;
      opacity: 0.85;
    }

    .surah-ar {
      font-size: 1.1rem;
      font-weight: 600;
      direction: rtl;
      text-align: right;
    }

    .selector {
      margin-top: 10px;
    }

    .selector label {
      display: block;
      font-size: 0.72rem;
      margin-bottom: 4px;
      opacity: 0.9;
    }

    select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.7);
      background: rgba(255,255,255,0.16);
      color: #fff;
      font-size: 0.85rem;
      outline: none;
      backdrop-filter: blur(8px);
    }

    select option {
      color: #222;
      background: #fff;
    }

    .body {
      padding: 16px;
      background: radial-gradient(circle at top, #f7f3ff, #f4f2f8);
    }

    .section-title {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--text-soft);
      text-align: center;
      margin: 10px 0 4px 0;
    }

    .section-sub {
      text-align: center;
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-bottom: 8px;
    }

    .grid-wrapper {
      background: #f7f3ff;
      border-radius: 12px;
      border: 1px solid var(--border-soft);
      padding: 10px;
      margin-bottom: 14px;
    }

    .verse-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(26px, 1fr));
      gap: 4px;
    }

    .verse {
      font-size: 0.7rem;
      text-align: center;
      padding: 4px 0;
      border-radius: 8px;
      border: 1px solid var(--border-soft);
      background: #fff;
      cursor: pointer;
      user-select: none;
      transition: background 0.15s ease, color 0.15s ease, transform 0.12s ease, box-shadow 0.12s ease, border-color 0.15s ease;
    }

    .verse:active {
      transform: scale(0.94);
    }

    .verse.mem-on {
      background: var(--mem-color);
      color: #fff;
      border-color: var(--mem-color);
      box-shadow: 0 0 0 1px rgba(0,0,0,0.03);
      font-weight: 600;
    }

    .verse.rev-on {
      background: #ffffff;
      border-color: var(--rev-color);
      box-shadow: 0 0 0 1px rgba(137,151,138,0.4);
      color: var(--rev-color);
      font-weight: 600;
    }

    .legend {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 6px;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .legend-dot {
      width: 14px;
      height: 14px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
    }

    .legend-dot.mem {
      background: var(--mem-color);
      border-color: var(--mem-color);
    }

    .legend-dot.rev {
      background: #ffffff;
      border-color: var(--rev-color);
    }

    .progress {
      margin-top: 10px;
      font-size: 0.72rem;
      color: var(--text-soft);
      text-align: center;
    }

    .footer-note {
      font-size: 0.72rem;
      color: var(--text-muted);
      text-align: center;
      margin-top: 8px;
      line-height: 1.4;
    }

    @media (min-width: 720px) {
      body { padding: 24px; }
      .body { padding: 18px 18px 22px 18px; }
      .verse-grid { gap: 5px; }
      .verse { font-size: 0.72rem; padding: 5px 0; }
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="top-bar">
      <div class="brand" id="brandText">NOOTQA · QUR'AN TRACKER</div>
      <div class="lang-switch">
        <span class="lang-label" id="langLabel">LANG</span>
        <button class="lang-btn active" data-lang="fr">FR</button>
        <button class="lang-btn" data-lang="en">EN</button>
      </div>
    </div>

    <div class="bismillah">
      بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ
    </div>

    <h1 id="mainTitle">TRACKER QURAN – HIFDH &amp; MOURĀJAʿA</h1>
    <div class="subtitle" id="subtitleText">
      Une mini-application simple pour suivre ta mémorisation et ta révision du Coran, sourate par sourate, verset par verset.
    </div>

    <div class="card">
      <div class="header-ribbon">
        <div class="header-top">
          <div class="header-text">
            <div class="surah-label" id="currentSurahLabel">Sourate actuelle</div>
            <div class="surah-name" id="surahLatin">78 – An-Naba</div>
            <div class="surah-meta" id="surahMeta">40 versets</div>
          </div>
          <div class="surah-ar" id="surahArabic">سورة النبأ</div>
        </div>

        <div class="selector">
          <label for="surahSelect" id="surahSelectLabel">Choisir une sourate :</label>
          <select id="surahSelect"></select>
        </div>
      </div>

      <div class="body">
        <div class="section">
          <div class="section-title" id="memTitle">Mémorisation (ḥifdh)</div>
          <div class="section-sub" id="memSub">Clique sur chaque verset que tu as mémorisé.</div>
          <div class="grid-wrapper">
            <div id="gridMem" class="verse-grid"></div>
            <div class="legend">
              <div class="legend-item">
                <div class="legend-dot mem"></div>
                <span id="legendMem">Mémorisé</span>
              </div>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-title" id="revTitle">Mourājaʿa (révision)</div>
          <div class="section-sub" id="revSub">Clique sur les versets que tu as révisés.</div>
          <div class="grid-wrapper">
            <div id="gridRev" class="verse-grid"></div>
            <div class="legend">
              <div class="legend-item">
                <div class="legend-dot rev"></div>
                <span id="legendRev">Révisé</span>
              </div>
            </div>
          </div>
        </div>

        <div class="progress" id="progressText">
          0 verset mémorisé · 0 verset révisé
        </div>

        <div class="footer-note" id="footerNote">
          Ce tracker se concentre sur l’essentiel : des numéros de versets clairs et une vision simple de ta progression.
        </div>
      </div>
    </div>
  </div>

  <div style="text-align:center;font-size:0.72rem;color:#999999;margin:14px 0;">
    © Nootqa Tracker — Usage strictement personnel. Reproduction ou diffusion interdite.
  </div>

  <script>
    const STRINGS = {
      fr: {
        brand: "NOOTQA · QUR'AN TRACKER",
        langLabel: "LANG",
        mainTitle: "TRACKER QURAN – HIFDH & MOURĀJAʿA",
        subtitle: "Une mini-application simple pour suivre ta mémorisation et ta révision du Coran, sourate par sourate, verset par verset.",
        currentSurahLabel: "Sourate actuelle",
        surahSelectLabel: "Choisir une sourate :",
        memTitle: "Mémorisation (ḥifdh)",
        memSub: "Clique sur chaque verset que tu as mémorisé.",
        revTitle: "Mourājaʿa (révision)",
        revSub: "Clique sur les versets que tu as révisés.",
        legendMem: "Mémorisé",
        legendRev: "Révisé",
        footerNote: "Ce tracker se concentre sur l’essentiel : des numéros de versets clairs et une vision simple de ta progression.",
        progress(memCount, revCount) {
          const mS = memCount > 1 ? "s" : "";
          const rS = revCount > 1 ? "s" : "";
          return `${memCount} verset${mS} mémorisé${mS} · ${revCount} verset${rS} révisé${rS}`;
        }
      },
      en: {
        brand: "NOOTQA · QUR'AN TRACKER",
        langLabel: "LANG",
        mainTitle: "QUR'AN TRACKER – HIFDH & REVISION",
        subtitle: "A simple mini-app to track your Qur'an memorisation and revision, surah by surah, verse by verse.",
        currentSurahLabel: "Current surah",
        surahSelectLabel: "Choose a surah:",
        memTitle: "Memorisation (ḥifdh)",
        memSub: "Tap each verse you have memorised.",
        revTitle: "Revision (murāja'ah)",
        revSub: "Tap the verses you have revised.",
        legendMem: "Memorised",
        legendRev: "Revised",
        footerNote: "This tracker focuses on what matters: clean verse numbers and a clear view of your progress.",
        progress(memCount, revCount) {
          const mWord = memCount === 1 ? "verse" : "verses";
          const rWord = revCount === 1 ? "verse" : "verses";
          return `${memCount} ${mWord} memorised · ${revCount} ${rWord} revised`;
        }
      }
    };

    const SURAH_DATA = [
      { n: 1, latin: "Al-Fatiha", arabic: "الفاتحة", verses: 7 },
      { n: 2, latin: "Al-Baqara", arabic: "البقرة", verses: 286 },
      { n: 3, latin: "Aal Imran", arabic: "آل عمران", verses: 200 },
      { n: 4, latin: "An-Nisa", arabic: "النساء", verses: 176 },
      { n: 5, latin: "Al-Ma'idah", arabic: "المائدة", verses: 120 },
      { n: 6, latin: "Al-An'am", arabic: "الأنعام", verses: 165 },
      { n: 7, latin: "Al-A'raf", arabic: "الأعراف", verses: 206 },
      { n: 8, latin: "Al-Anfal", arabic: "الأنفال", verses: 75 },
      { n: 9, latin: "At-Tawbah", arabic: "التوبة", verses: 129 },
      { n: 10, latin: "Yunus", arabic: "يونس", verses: 109 },
      { n: 11, latin: "Hud", arabic: "هود", verses: 123 },
      { n: 12, latin: "Yusuf", arabic: "يوسف", verses: 111 },
      { n: 13, latin: "Ar-Ra'd", arabic: "الرعد", verses: 43 },
      { n: 14, latin: "Ibrahim", arabic: "إبراهيم", verses: 52 },
      { n: 15, latin: "Al-Hijr", arabic: "الحجر", verses: 99 },
      { n: 16, latin: "An-Nahl", arabic: "النحل", verses: 128 },
      { n: 17, latin: "Al-Isra", arabic: "الإسراء", verses: 111 },
      { n: 18, latin: "Al-Kahf", arabic: "الكهف", verses: 110 },
      { n: 19, latin: "Maryam", arabic: "مريم", verses: 98 },
      { n: 20, latin: "Ta-Ha", arabic: "طه", verses: 135 },
      { n: 21, latin: "Al-Anbiya", arabic: "الأنبياء", verses: 112 },
      { n: 22, latin: "Al-Hajj", arabic: "الحج", verses: 78 },
      { n: 23, latin: "Al-Mu'minun", arabic: "المؤمنون", verses: 118 },
      { n: 24, latin: "An-Nur", arabic: "النور", verses: 64 },
      { n: 25, latin: "Al-Furqan", arabic: "الفرقان", verses: 77 },
      { n: 26, latin: "Ash-Shu'ara", arabic: "الشعراء", verses: 227 },
      { n: 27, latin: "An-Naml", arabic: "النمل", verses: 93 },
      { n: 28, latin: "Al-Qasas", arabic: "القصص", verses: 88 },
      { n: 29, latin: "Al-Ankabut", arabic: "العنكبوت", verses: 69 },
      { n: 30, latin: "Ar-Rum", arabic: "الروم", verses: 60 },
      { n: 31, latin: "Luqman", arabic: "لقمان", verses: 34 },
      { n: 32, latin: "As-Sajda", arabic: "السجدة", verses: 30 },
      { n: 33, latin: "Al-Ahzab", arabic: "الأحزاب", verses: 73 },
      { n: 34, latin: "Saba", arabic: "سبأ", verses: 54 },
      { n: 35, latin: "Fatir", arabic: "فاطر", verses: 45 },
      { n: 36, latin: "Ya-Sin", arabic: "يس", verses: 83 },
      { n: 37, latin: "As-Saffat", arabic: "الصافات", verses: 182 },
      { n: 38, latin: "Sad", arabic: "ص", verses: 88 },
      { n: 39, latin: "Az-Zumar", arabic: "الزمر", verses: 75 },
      { n: 40, latin: "Ghafir", arabic: "غافر", verses: 85 },
      { n: 41, latin: "Fussilat", arabic: "فصلت", verses: 54 },
      { n: 42, latin: "Ash-Shura", arabic: "الشورى", verses: 53 },
      { n: 43, latin: "Az-Zukhruf", arabic: "الزخرف", verses: 89 },
      { n: 44, latin: "Ad-Dukhan", arabic: "الدخان", verses: 59 },
      { n: 45, latin: "Al-Jathiyah", arabic: "الجاثية", verses: 37 },
      { n: 46, latin: "Al-Ahqaf", arabic: "الأحقاف", verses: 35 },
      { n: 47, latin: "Muhammad", arabic: "محمد", verses: 38 },
      { n: 48, latin: "Al-Fath", arabic: "الفتح", verses: 29 },
      { n: 49, latin: "Al-Hujurat", arabic: "الحجرات", verses: 18 },
      { n: 50, latin: "Qaf", arabic: "ق", verses: 45 },
      { n: 51, latin: "Adh-Dhariyat", arabic: "الذاريات", verses: 60 },
      { n: 52, latin: "At-Tur", arabic: "الطور", verses: 49 },
      { n: 53, latin: "An-Najm", arabic: "النجم", verses: 62 },
      { n: 54, latin: "Al-Qamar", arabic: "القمر", verses: 55 },
      { n: 55, latin: "Ar-Rahman", arabic: "الرحمن", verses: 78 },
      { n: 56, latin: "Al-Waqi'ah", arabic: "الواقعة", verses: 96 },
      { n: 57, latin: "Al-Hadid", arabic: "الحديد", verses: 29 },
      { n: 58, latin: "Al-Mujadila", arabic: "المجادلة", verses: 22 },
      { n: 59, latin: "Al-Hashr", arabic: "الحشر", verses: 24 },
      { n: 60, latin: "Al-Mumtahanah", arabic: "الممتحنة", verses: 13 },
      { n: 61, latin: "As-Saff", arabic: "الصف", verses: 14 },
      { n: 62, latin: "Al-Jumu'ah", arabic: "الجمعة", verses: 11 },
      { n: 63, latin: "Al-Munafiqun", arabic: "المنافقون", verses: 11 },
      { n: 64, latin: "At-Taghabun", arabic: "التغابن", verses: 18 },
      { n: 65, latin: "At-Talaq", arabic: "الطلاق", verses: 12 },
      { n: 66, latin: "At-Tahrim", arabic: "التحريم", verses: 12 },
      { n: 67, latin: "Al-Mulk", arabic: "الملك", verses: 30 },
      { n: 68, latin: "Al-Qalam", arabic: "القلم", verses: 52 },
      { n: 69, latin: "Al-Haqqah", arabic: "الحاقة", verses: 52 },
      { n: 70, latin: "Al-Ma'arij", arabic: "المعارج", verses: 44 },
      { n: 71, latin: "Nuh", arabic: "نوح", verses: 28 },
      { n: 72, latin: "Al-Jinn", arabic: "الجن", verses: 28 },
      { n: 73, latin: "Al-Muzzammil", arabic: "المزمل", verses: 20 },
      { n: 74, latin: "Al-Muddaththir", arabic: "المدثر", verses: 56 },
      { n: 75, latin: "Al-Qiyamah", arabic: "القيامة", verses: 40 },
      { n: 76, latin: "Al-Insan", arabic: "الإنسان", verses: 31 },
      { n: 77, latin: "Al-Mursalat", arabic: "المرسلات", verses: 50 },
      { n: 78, latin: "An-Naba", arabic: "النبأ", verses: 40 },
      { n: 79, latin: "An-Nazi'at", arabic: "النازعات", verses: 46 },
      { n: 80, latin: "Abasa", arabic: "عبس", verses: 42 },
      { n: 81, latin: "At-Takwir", arabic: "التكوير", verses: 29 },
      { n: 82, latin: "Al-Infitar", arabic: "الإنفطار", verses: 19 },
      { n: 83, latin: "Al-Mutaffifin", arabic: "المطففين", verses: 36 },
      { n: 84, latin: "Al-Inshiqaq", arabic: "الإنشقاق", verses: 25 },
      { n: 85, latin: "Al-Buruj", arabic: "البروج", verses: 22 },
      { n: 86, latin: "At-Tariq", arabic: "الطارق", verses: 17 },
      { n: 87, latin: "Al-A'la", arabic: "الأعلى", verses: 19 },
      { n: 88, latin: "Al-Ghashiyah", arabic: "الغاشية", verses: 26 },
      { n: 89, latin: "Al-Fajr", arabic: "الفجر", verses: 30 },
      { n: 90, latin: "Al-Balad", arabic: "البلد", verses: 20 },
      { n: 91, latin: "Ash-Shams", arabic: "الشمس", verses: 15 },
      { n: 92, latin: "Al-Layl", arabic: "الليل", verses: 21 },
      { n: 93, latin: "Ad-Duha", arabic: "الضحى", verses: 11 },
      { n: 94, latin: "Ash-Sharh", arabic: "الشرح", verses: 8 },
      { n: 95, latin: "At-Tin", arabic: "التين", verses: 8 },
      { n: 96, latin: "Al-Alaq", arabic: "العلق", verses: 19 },
      { n: 97, latin: "Al-Qadr", arabic: "القدر", verses: 5 },
      { n: 98, latin: "Al-Bayyinah", arabic: "البينة", verses: 8 },
      { n: 99, latin: "Az-Zalzalah", arabic: "الزلزلة", verses: 8 },
      { n: 100, latin: "Al-Adiyat", arabic: "العاديات", verses: 11 },
      { n: 101, latin: "Al-Qari'ah", arabic: "القارعة", verses: 11 },
      { n: 102, latin: "At-Takathur", arabic: "التكاثر", verses: 8 },
      { n: 103, latin: "Al-Asr", arabic: "العصر", verses: 3 },
      { n: 104, latin: "Al-Humazah", arabic: "الهمزة", verses: 9 },
      { n: 105, latin: "Al-Fil", arabic: "الفيل", verses: 5 },
      { n: 106, latin: "Quraysh", arabic: "قريش", verses: 4 },
      { n: 107, latin: "Al-Ma'un", arabic: "الماعون", verses: 7 },
      { n: 108, latin: "Al-Kawthar", arabic: "الكوثر", verses: 3 },
      { n: 109, latin: "Al-Kafirun", arabic: "الكافرون", verses: 6 },
      { n: 110, latin: "An-Nasr", arabic: "النصر", verses: 3 },
      { n: 111, latin: "Al-Masad", arabic: "المسد", verses: 5 },
      { n: 112, latin: "Al-Ikhlas", arabic: "الإخلاص", verses: 4 },
      { n: 113, latin: "Al-Falaq", arabic: "الفلق", verses: 5 },
      { n: 114, latin: "An-Nas", arabic: "الناس", verses: 6 }
    ];

    const el = id => document.getElementById(id);

    const langButtons = document.querySelectorAll(".lang-btn");
    const brandText = el("brandText");
    const langLabel = el("langLabel");
    const mainTitle = el("mainTitle");
    const subtitleText = el("subtitleText");
    const currentSurahLabel = el("currentSurahLabel");
    const surahSelectLabel = el("surahSelectLabel");
    const memTitle = el("memTitle");
    const memSub = el("memSub");
    const revTitle = el("revTitle");
    const revSub = el("revSub");
    const legendMem = el("legendMem");
    const legendRev = el("legendRev");
    const footerNote = el("footerNote");
    const progressText = el("progressText");
    const surahLatin = el("surahLatin");
    const surahArabic = el("surahArabic");
    const surahMeta = el("surahMeta");
    const surahSelect = el("surahSelect");
    const gridMem = el("gridMem");
    const gridRev = el("gridRev");

    let currentLang = "fr";

    function applyLang(lang) {
      currentLang = lang;
      const S = STRINGS[lang] || STRINGS.fr;

      brandText.textContent = S.brand;
      langLabel.textContent = S.langLabel;
      mainTitle.textContent = S.mainTitle;
      subtitleText.textContent = S.subtitle;
      currentSurahLabel.textContent = S.currentSurahLabel;
      surahSelectLabel.textContent = S.surahSelectLabel;
      memTitle.textContent = S.memTitle;
      memSub.textContent = S.memSub;
      revTitle.textContent = S.revTitle;
      revSub.textContent = S.revSub;
      legendMem.textContent = S.legendMem;
      legendRev.textContent = S.legendRev;
      footerNote.textContent = S.footerNote;

      document.documentElement.lang = lang;
      document.body.dir = "ltr";

      updateProgress(parseInt(surahSelect.value || "78", 10));
    }

    langButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        langButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        applyLang(btn.dataset.lang);
      });
    });

    function storageKeyMem(surah, verse) {
      return `nootqa_mem_${surah}_${verse}`;
    }

    function storageKeyRev(surah, verse) {
      return `nootqa_rev_${surah}_${verse}`;
    }

    function renderSurah(num) {
      const s = SURAH_DATA.find(x => x.n === num);
      if (!s) return;

      surahLatin.textContent = `${s.n} – ${s.latin}`;
      surahArabic.textContent = "سورة " + s.arabic;
      surahMeta.textContent = `${s.verses} versets`;

      gridMem.innerHTML = "";
      gridRev.innerHTML = "";

      for (let i = 1; i <= s.verses; i++) {
        const memDiv = document.createElement("div");
        memDiv.className = "verse";
        memDiv.textContent = i;
        const memKey = storageKeyMem(s.n, i);
        if (localStorage.getItem(memKey) === "1") {
          memDiv.classList.add("mem-on");
        }
        memDiv.addEventListener("click", () => {
          if (memDiv.classList.contains("mem-on")) {
            memDiv.classList.remove("mem-on");
            localStorage.removeItem(memKey);
          } else {
            memDiv.classList.add("mem-on");
            localStorage.setItem(memKey, "1");
          }
          updateProgress(s.n);
        });
        gridMem.appendChild(memDiv);

        const revDiv = document.createElement("div");
        revDiv.className = "verse";
        revDiv.textContent = i;
        const revKey = storageKeyRev(s.n, i);
        if (localStorage.getItem(revKey) === "1") {
          revDiv.classList.add("rev-on");
        }
        revDiv.addEventListener("click", () => {
          if (revDiv.classList.contains("rev-on")) {
            revDiv.classList.remove("rev-on");
            localStorage.removeItem(revKey);
          } else {
            revDiv.classList.add("rev-on");
            localStorage.setItem(revKey, "1");
          }
          updateProgress(s.n);
        });
        gridRev.appendChild(revDiv);
      }

      updateProgress(s.n);
    }

    function updateProgress(surah) {
      const s = SURAH_DATA.find(x => x.n === surah);
      if (!s) return;
      let memCount = 0;
      let revCount = 0;
      for (let i = 1; i <= s.verses; i++) {
        if (localStorage.getItem(storageKeyMem(surah, i)) === "1") memCount++;
        if (localStorage.getItem(storageKeyRev(surah, i)) === "1") revCount++;
      }
      const S = STRINGS[currentLang] || STRINGS.fr;
      progressText.textContent = S.progress(memCount, revCount);
    }

    function init() {
      const select = document.getElementById("surahSelect");
      SURAH_DATA.forEach(s => {
        const opt = document.createElement("option");
        opt.value = s.n;
        opt.textContent = `${s.n} – ${s.latin}`;
        select.appendChild(opt);
      });

      select.addEventListener("change", () => {
        const num = parseInt(select.value, 10);
        renderSurah(num);
      });

      select.value = "78";
      renderSurah(78);

      applyLang("fr");
    }

    document.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>
